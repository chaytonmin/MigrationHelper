# Recommending Library For Migration

## Data Documentation

### Ground Truth Data

- data/rules-2014-raw.csv

  Each line in this file is a migration rule, format: original library name, substitute library name, a score for this rule.

  Notice that, we did not use the score in our evaluation.

- data/rules-artifactList.csv

  Each line in this file is a mapping between library name and it's ID generated by MySQL.

  This mapping is manually constructed.

## Code Documentation

### Directory Structure

All files of our tool are stored in 'src' directory:

- src/main/java

  The source code files of this project are stored in this directory.

- src/main/resources

  The configuration files of this project are stored in this directory.

All source code files are stored in root package 'anonymous.migrationhelper' which is in the source code directory.  'Application.java' file stored in root package is the entrance of our tool. The documentation of sub-package:

- config

  The codes used to configurate running environment are stored in this package.

- data

  The database object-orient models are stored in this package.

- job

  When the program starts, our tool's framework will choose a job to run from this package.

- mapper

  The database access interfaces are stored in this package.

- service

  The codes which implement out mining and recommending algorithms are stored in this package.

- util

  Some functional codes are stored in this package.

- woc

  The World of Code access classes are stored in this package.

### Important Function

#### Mining Libraries and it's APIs

Relevant jobs:

- LibrariesIoImportJob

  Import Maven artifacts from Libraries.io into our database.

- LioJarParseJob

  Download jars from Maven and analyze the APIs in those jars.

Relevant services:

- LibraryIdentityService

  Main logic of downloading jars and constructing library-API mapping.

- JarAnalysisService

  Implementation of analyzing jar to extract APIs.

#### Mining Software Repositories

Relevant jobs:

- WocRepoAnalysisJob

  Analyze a list of software repositories on World of Code to extract dependency changes and API changes.

Relevant services:

- RepositoryAnalysisService

  Main logic of analyzing repositories.

#### Recommending Libraries

Relevant services:

- DependencyChangePatternAnalysisService

  Implementation of candidate migration rules mining algorithm and metric based recommendation algorithm.

### How to Run

Since our tool relies on World of Code to provide repositories for mining, users who can not access World of Code can only run the 'Mining Libraries and it's APIs' function. We will introduce how to run this function.

#### Environment

- Java: JDK 1.8
- MySQL: 5.7

#### Configuration

- application.yaml

  Make sure the attribute value of 'spring.profiles.active' is 'local' which indicates that we will running our program on local environment instead of World of Code environment.

- application-local.yaml

  Modify the attribute 'migration-helper.job.enabled' to the name of the job that you want to start.

  Modify the attribute 'migration-helper.libraries-io-import.project-with-repository-path' to the path you store the 'projects_with_repository.csv' file that downloaded from Libraries.io.

  Modify the attribute 'migration-helper.lio-jar-parse.limit-count' to the maximum number of libraries that you want to analyze.

  Modify the attribute 'migration-helper.lio-jar-parse.extract-version-only'. If you only want to extract version information from Maven but do not want to analyze APIs in libraries, fill in 'true', otherwise, 'false'.

  Modify the attributes in 'spring.datasource.dbcp2' to fill in your MySQL database connection information.

#### Jobs to Run

- CreateTableJob

  Run this job when you create your database first time. This job will create tables in the database you specific.

- LibrariesIoImportJob

  Run this job to import Maven artifacts into our database from Libraries.io csv files.

- LioJarParseJob

  Run this job to download and analyze libraries to construct library-API mapping. The results are stored in table 'library\_group\_artifact', 'library\_version', 'method\_signature\_\*', 'library\_signature\_to\_version\_\*', 'library\_version\_to\_signature'.

#### Compile and Run

- Compile with Maven

  Execute this command in the directory where the 'pom.xml' file locate:

  ```shell
  mvn clean package
  ```

  The executable jar file will be saved into 'target/migration-helper-1.0-SNAPSHOT.jar'.

- Run with Java

  Execute this command to run the program:

  ```
  java -jar ./target/migration-helper-1.0-SNAPSHOT.jar
  ```

  

